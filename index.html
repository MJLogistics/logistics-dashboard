<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MJL ë¬¼ë¥˜ ìš´ì„ ìƒì„¸ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1920px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #e0e0e0;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        
        .control-panel {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .time-range-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .time-btn {
            padding: 10px 20px;
            border: 2px solid #e74c3c;
            background: white;
            color: #e74c3c;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
        }
        
        .time-btn.active {
            background: #e74c3c;
            color: white;
        }
        
        .time-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border-top: 4px solid;
        }
        
        .metric-card:nth-child(1) { border-top-color: #3498db; }
        .metric-card:nth-child(2) { border-top-color: #e74c3c; }
        .metric-card:nth-child(3) { border-top-color: #f39c12; }
        .metric-card:nth-child(4) { border-top-color: #2ecc71; }
        
        .metric-title {
            font-size: 0.9em;
            color: #7f8c8d;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .metric-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .metric-change {
            font-size: 1em;
            padding: 5px 10px;
            border-radius: 12px;
            display: inline-block;
            font-weight: 600;
        }
        
        .negative {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }
        
        .chart-canvas {
            position: relative;
            height: 400px;
            width: 100%;
        }
        
        #freightAnalysis {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        #analysisContent {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .analysis-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>ğŸš¢ âœˆï¸ MJL ë¬¼ë¥˜ ìš´ì„ ìƒì„¸ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
            <div class="subtitle">DETAILED FREIGHT RATE ANALYSIS</div>
        </div>

        <div class="control-panel">
            <div style="text-align: center; font-weight: 600; color: #2c3e50; margin-bottom: 15px;">
                ğŸ“Š ë¶„ì„ ê¸°ê°„ ì„ íƒ
            </div>
            <div class="time-range-buttons">
                <button class="time-btn" data-range="3M">3ê°œì›”</button>
                <button class="time-btn" data-range="6M">6ê°œì›”</button>
                <button class="time-btn active" data-range="1Y">1ë…„</button>
                <button class="time-btn" data-range="2Y">2ë…„</button>
            </div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">ë°œí‹±ìš´ì„ì§€ìˆ˜ (BDI)</div>
                <div class="metric-value" id="bdiValue">1,140</div>
                <span class="metric-change negative" id="bdiChange">â–¼ 42.5%</span>
            </div>
            <div class="metric-card">
                <div class="metric-title">ìƒí•´ì»¨í…Œì´ë„ˆìš´ì„ì§€ìˆ˜ (SCFI)</div>
                <div class="metric-value" id="scfiValue">984.73</div>
                <span class="metric-change negative" id="scfiChange">â–¼ 18.2%</span>
            </div>
            <div class="metric-card">
                <div class="metric-title">ì¤‘êµ­ì»¨í…Œì´ë„ˆìš´ì„ì§€ìˆ˜ (CCFI)</div>
                <div class="metric-value" id="ccfiValue">962.64</div>
                <span class="metric-change negative" id="ccfiChange">â–¼ 15.7%</span>
            </div>
            <div class="metric-card">
                <div class="metric-title">HRCI ì§€ìˆ˜</div>
                <div class="metric-value" id="hrciValue">635.6</div>
                <span class="metric-change negative" id="hrciChange">â–¼ 8.3%</span>
            </div>
        </div>

        <div id="freightAnalysis">
            <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.5em;">
                ğŸ“ˆ ìš´ì„ ë³€ë™ ìƒì„¸ ë¶„ì„ <span id="analysisDateRange" style="color: #7f8c8d; font-size: 0.8em;"></span>
            </h3>
            <div id="analysisContent">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë¶„ì„ ë‚´ìš© -->
            </div>
        </div>

        <div class="chart-container">
            <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“Š í•´ìš´ ì§€ìˆ˜ ì¶”ì´</h3>
            <div class="chart-canvas">
                <canvas id="indexChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë°ì´í„° ê°ì²´
        const currentData = {
            dates: [],
            indices: {
                BDI: [], SCFI: [], CCFI: [], HRCI: []
            },
            freight: {
                shanghai: {
                    sea: { la: [], longbeach: [], rotterdam: [], kandla: [], paradip: [], jnpt: [] },
                    air: { lax: [], jfk: [], vie: [], del: [], bom: [], blr: [] }
                },
                hongkong: {
                    sea: { la: [], longbeach: [], rotterdam: [], kandla: [], paradip: [], jnpt: [] },
                    air: { lax: [], jfk: [], vie: [], del: [], bom: [], blr: [] }
                },
                shenzhen: {
                    sea: { la: [], longbeach: [], rotterdam: [], kandla: [], paradip: [], jnpt: [] },
                    air: { lax: [], jfk: [], vie: [], del: [], bom: [], blr: [] }
                },
                hanoi: {
                    sea: { la: [], longbeach: [], rotterdam: [], kandla: [], paradip: [], jnpt: [] },
                    air: { lax: [], jfk: [], vie: [], del: [], bom: [], blr: [] }
                },
                hochiminh: {
                    sea: { la: [], longbeach: [], rotterdam: [], kandla: [], paradip: [], jnpt: [] },
                    air: { lax: [], jfk: [], vie: [], del: [], bom: [], blr: [] }
                }
            }
        };

        let charts = {};

        // ë°ì´í„° ìƒì„± í•¨ìˆ˜
        function generateRealisticData() {
            const startDate = new Date('2024-01-01');
            const endDate = new Date('2025-01-21');
            
            // ì‹¤ì œì™€ ìœ ì‚¬í•œ íŒ¨í„´ ìƒì„±
            let week = 0;
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 7)) {
                currentData.dates.push(new Date(d));
                
                // ê³„ì ˆì„±ê³¼ íŠ¸ë Œë“œ ë°˜ì˜
                const yearProgress = week / 52;
                const seasonalFactor = 1 + 0.2 * Math.sin(2 * Math.PI * yearProgress);
                const trendFactor = 1 - yearProgress * 0.35;
                const volatility = (Math.random() - 0.5) * 0.1;
                
                // BDI: 1980 â†’ 2850(peak) â†’ 1140
                let bdiValue;
                if (week < 13) {
                    bdiValue = 1980 + week * 30;
                } else if (week < 26) {
                    bdiValue = 2370 + (week - 13) * 38;
                } else if (week < 39) {
                    bdiValue = 2850 - (week - 26) * 45;
                } else {
                    bdiValue = 2265 - (week - 39) * 62;
                }
                currentData.indices.BDI.push(Math.round(bdiValue * (1 + volatility)));
                
                // SCFI: 1204 â†’ 984.73
                const scfiValue = 1204 * trendFactor * seasonalFactor * (1 + volatility);
                currentData.indices.SCFI.push(Math.round(scfiValue * 100) / 100);
                
                // CCFIì™€ HRCI
                currentData.indices.CCFI.push(Math.round(1142 * trendFactor * (1 + volatility) * 100) / 100);
                currentData.indices.HRCI.push(Math.round(693 * trendFactor * (1 + volatility) * 10) / 10);
                
                // ìš´ì„ ë°ì´í„°
                const origins = ['shanghai', 'hongkong', 'shenzhen', 'hanoi', 'hochiminh'];
                origins.forEach(origin => {
                    // í•´ìƒ ìš´ì„
                    currentData.freight[origin].sea.la.push(Math.round(2450 * trendFactor * seasonalFactor * (1 + volatility)));
                    currentData.freight[origin].sea.longbeach.push(Math.round(2480 * trendFactor * seasonalFactor * (1 + volatility)));
                    currentData.freight[origin].sea.rotterdam.push(Math.round(4850 * trendFactor * seasonalFactor * (1 + volatility)));
                    currentData.freight[origin].sea.kandla.push(Math.round(1250 * trendFactor * seasonalFactor * (1 + volatility)));
                    currentData.freight[origin].sea.paradip.push(Math.round(1280 * trendFactor * seasonalFactor * (1 + volatility)));
                    currentData.freight[origin].sea.jnpt.push(Math.round(1320 * trendFactor * seasonalFactor * (1 + volatility)));
                    
                    // í•­ê³µ ìš´ì„
                    currentData.freight[origin].air.lax.push(Math.round(6.85 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                    currentData.freight[origin].air.jfk.push(Math.round(7.12 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                    currentData.freight[origin].air.vie.push(Math.round(5.92 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                    currentData.freight[origin].air.del.push(Math.round(4.78 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                    currentData.freight[origin].air.bom.push(Math.round(4.85 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                    currentData.freight[origin].air.blr.push(Math.round(4.92 * trendFactor * (1 + volatility * 0.5) * 100) / 100);
                });
                
                week++;
            }
        }

        // ê°œì„ ëœ ìƒì„¸ ë¶„ì„ í•¨ìˆ˜
        function analyzeFreightChanges(timeRange) {
            const analysisContent = document.getElementById('analysisContent');
            const dateRangeSpan = document.getElementById('analysisDateRange');
            
            // ì‹œê°„ ë²”ìœ„ ê³„ì‚°
            let dataPoints = 52;
            const endDate = new Date('2025-01-21');
            let startDate = new Date('2025-01-21');
            
            switch(timeRange) {
                case '3M':
                    dataPoints = 13;
                    startDate.setMonth(endDate.getMonth() - 3);
                    break;
                case '6M':
                    dataPoints = 26;
                    startDate.setMonth(endDate.getMonth() - 6);
                    break;
                case '1Y':
                    dataPoints = 52;
                    startDate.setFullYear(endDate.getFullYear() - 1);
                    break;
                case '2Y':
                    dataPoints = 104;
                    startDate.setFullYear(endDate.getFullYear() - 2);
                    break;
            }
            
            const periodText = `${startDate.getFullYear()}.${String(startDate.getMonth() + 1).padStart(2, '0')} ~ ${endDate.getFullYear()}.${String(endDate.getMonth() + 1).padStart(2, '0')}`;
            dateRangeSpan.textContent = `(${periodText})`;
            
            // ë°ì´í„° ìŠ¬ë¼ì´ìŠ¤
            const startIdx = Math.max(0, currentData.dates.length - dataPoints);
            const dates = currentData.dates.slice(startIdx);
            
            // BDI ìƒì„¸ ë¶„ì„
            const bdiData = currentData.indices.BDI.slice(startIdx);
            const scfiData = currentData.indices.SCFI.slice(startIdx);
            const shanghaiLA = currentData.freight.shanghai.sea.la.slice(startIdx);
            const shanghaiRotterdam = currentData.freight.shanghai.sea.rotterdam.slice(startIdx);
            const shanghaiLAX = currentData.freight.shanghai.air.lax.slice(startIdx);
            
            let analysisHTML = '';
            
            // BDI ë¶„ì„ ì¹´ë“œ
            analysisHTML += createDetailedAnalysisCard('BDI ì§€ìˆ˜', bdiData, dates, '#3498db', '');
            
            // SCFI ë¶„ì„ ì¹´ë“œ
            analysisHTML += createDetailedAnalysisCard('SCFI ì§€ìˆ˜', scfiData, dates, '#e74c3c', '');
            
            // ë¶ë¯¸ í•´ìƒ ìš´ì„ ë¶„ì„ ì¹´ë“œ
            analysisHTML += createDetailedAnalysisCard('ìƒí•´â†’LA í•´ìƒ', shanghaiLA, dates, '#f39c12', 'USD/TEU');
            
            // ìœ ëŸ½ í•´ìƒ ìš´ì„ ë¶„ì„ ì¹´ë“œ
            analysisHTML += createDetailedAnalysisCard('ìƒí•´â†’ë¡œí…Œë¥´ë‹´ í•´ìƒ', shanghaiRotterdam, dates, '#2ecc71', 'USD/TEU');
            
            // í•­ê³µ ìš´ì„ ë¶„ì„ ì¹´ë“œ
            analysisHTML += createDetailedAnalysisCard('ìƒí•´â†’LAX í•­ê³µ', shanghaiLAX, dates, '#9b59b6', 'USD/kg', true);
            
            // ì¢…í•© ìš”ì•½ ì¹´ë“œ
            analysisHTML += createSummaryCard(bdiData, scfiData, shanghaiLA, shanghaiRotterdam, shanghaiLAX, dates);
            
            analysisContent.innerHTML = analysisHTML;
            
            // ë©”íŠ¸ë¦­ ì¹´ë“œ ì—…ë°ì´íŠ¸
            updateMetricCards(startIdx);
        }

        // ìƒì„¸ ë¶„ì„ ì¹´ë“œ ìƒì„± í•¨ìˆ˜
        function createDetailedAnalysisCard(title, data, dates, color, unit, isDecimal = false) {
            if (data.length < 2) return '';
            
            let html = `
                <div class="analysis-card" style="border-left-color: ${color};">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">ğŸ“Š ${title} ìƒì„¸ ë³€ë™</h4>
                    <div style="color: #34495e; line-height: 1.8; font-size: 0.9em;">
            `;
            
            // ë¶„ê¸°ë³„ ë¶„ì„
            const quarters = Math.floor(data.length / 13); // 13ì£¼ = 1ë¶„ê¸°
            
            if (quarters >= 1) {
                for (let i = 0; i <= quarters && i * 13 < data.length; i++) {
                    const qStart = i * 13;
                    const qEnd = Math.min((i + 1) * 13 - 1, data.length - 1);
                    
                    if (qEnd <= qStart) continue;
                    
                    const qStartValue = isDecimal ? data[qStart].toFixed(2) : data[qStart];
                    const qEndValue = isDecimal ? data[qEnd].toFixed(2) : data[qEnd];
                    const qMax = isDecimal ? Math.max(...data.slice(qStart, qEnd + 1)).toFixed(2) : Math.max(...data.slice(qStart, qEnd + 1));
                    const qMin = isDecimal ? Math.min(...data.slice(qStart, qEnd + 1)).toFixed(2) : Math.min(...data.slice(qStart, qEnd + 1));
                    const qChange = ((data[qEnd] - data[qStart]) / data[qStart] * 100).toFixed(1);
                    
                    const startDateStr = formatDate(dates[qStart]);
                    const endDateStr = qEnd < data.length - 1 ? formatDate(dates[qEnd]) : 'í˜„ì¬';
                    
                    html += `<strong>${i === quarters ? 'í˜„ì¬' : (i+1)+'ë¶„ê¸°'} (${startDateStr} ~ ${endDateStr}):</strong><br>`;
                    html += `â€¢ ì‹œì‘: <span style="color: ${color}; font-weight: bold;">${unit ? '$' : ''}${qStartValue}${unit ? '/' + unit : ''}</span> â†’ `;
                    html += `ì¢…ë£Œ: <span style="color: ${color}; font-weight: bold;">${unit ? '$' : ''}${qEndValue}${unit ? '/' + unit : ''}</span> `;
                    html += `(${qChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(qChange)}%)<br>`;
                    html += `â€¢ ìµœê³ : ${unit ? '$' : ''}${qMax} / ìµœì €: ${unit ? '$' : ''}${qMin}<br><br>`;
                }
            } else {
                // ì›”ë³„ ë¶„ì„
                for (let i = 0; i < data.length; i += 4) {
                    const monthData = data.slice(i, Math.min(i + 4, data.length));
                    const monthAvg = monthData.reduce((a, b) => a + b, 0) / monthData.length;
                    const displayValue = isDecimal ? monthAvg.toFixed(2) : Math.round(monthAvg);
                    
                    if (i > 0) {
                        const prevMonthData = data.slice(Math.max(0, i - 4), i);
                        const prevMonthAvg = prevMonthData.reduce((a, b) => a + b, 0) / prevMonthData.length;
                        const change = ((monthAvg - prevMonthAvg) / prevMonthAvg * 100).toFixed(1);
                        
                        html += `${formatMonth(dates[i])}: ${unit ? '$' : ''}${displayValue}${unit ? '/' + unit : ''} (${change > 0 ? '+' : ''}${change}%)<br>`;
                    } else {
                        html += `${formatMonth(dates[i])}: ${unit ? '$' : ''}${displayValue}${unit ? '/' + unit : ''} (ê¸°ì¤€ì )<br>`;
                    }
                }
            }
            
            // ì „ì²´ ë³€ë™
            const totalChange = ((data[data.length-1] - data[0]) / data[0] * 100).toFixed(1);
            const startVal = isDecimal ? data[0].toFixed(2) : data[0];
            const endVal = isDecimal ? data[data.length-1].toFixed(2) : data[data.length-1];
            
            html += `<strong style="color: #e74c3c;">ì „ì²´ ë³€ë™:</strong> ${unit ? '$' : ''}${startVal} â†’ ${unit ? '$' : ''}${endVal} (${totalChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(totalChange)}%)`;
            
            html += `
                    </div>
                </div>
            `;
            
            return html;
        }

        // ì¢…í•© ìš”ì•½ ì¹´ë“œ ìƒì„±
        function createSummaryCard(bdiData, scfiData, usData, euData, airData, dates) {
            return `
                <div class="analysis-card" style="border-left-color: #34495e;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">ğŸ“ˆ ì¢…í•© ìˆ˜ì¹˜ ìš”ì•½</h4>
                    <div style="color: #34495e; line-height: 1.8; font-size: 0.9em;">
                        <strong>ë¶„ì„ ê¸°ê°„:</strong> ${formatDate(dates[0])} ~ ${formatDate(dates[dates.length-1])} (${dates.length}ì£¼)<br><br>
                        
                        <strong>ì£¼ìš” ì§€í‘œ ë³€ë™ë¥ :</strong><br>
                        â€¢ BDI: ${((bdiData[bdiData.length-1] - bdiData[0]) / bdiData[0] * 100).toFixed(1)}%<br>
                        â€¢ SCFI: ${((scfiData[scfiData.length-1] - scfiData[0]) / scfiData[0] * 100).toFixed(1)}%<br>
                        â€¢ ë¶ë¯¸ í•´ìƒ: ${((usData[usData.length-1] - usData[0]) / usData[0] * 100).toFixed(1)}%<br>
                        â€¢ ìœ ëŸ½ í•´ìƒ: ${((euData[euData.length-1] - euData[0]) / euData[0] * 100).toFixed(1)}%<br>
                        â€¢ í•­ê³µ: ${((airData[airData.length-1] - airData[0]) / airData[0] * 100).toFixed(1)}%<br><br>
                        
                        <strong>ë³€ë™í­ (ìµœì €~ìµœê³ ):</strong><br>
                        â€¢ BDI: ${Math.min(...bdiData)} ~ ${Math.max(...bdiData)}<br>
                        â€¢ ë¶ë¯¸ í•´ìƒ: $${Math.min(...usData)} ~ $${Math.max(...usData)}/TEU<br>
                        â€¢ ìœ ëŸ½ í•´ìƒ: $${Math.min(...euData)} ~ $${Math.max(...euData)}/TEU<br>
                        â€¢ í•­ê³µ: $${Math.min(...airData).toFixed(2)} ~ $${Math.max(...airData).toFixed(2)}/kg
                    </div>
                </div>
            `;
        }

        // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
        function formatDate(date) {
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        function formatMonth(date) {
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}`;
        }

        // ë©”íŠ¸ë¦­ ì¹´ë“œ ì—…ë°ì´íŠ¸
        function updateMetricCards(startIdx) {
            const bdiData = currentData.indices.BDI.slice(startIdx);
            const scfiData = currentData.indices.SCFI.slice(startIdx);
            const ccfiData = currentData.indices.CCFI.slice(startIdx);
            const hrciData = currentData.indices.HRCI.slice(startIdx);
            
            if (bdiData.length > 0) {
                document.getElementById('bdiValue').textContent = bdiData[bdiData.length-1].toLocaleString();
                document.getElementById('scfiValue').textContent = scfiData[scfiData.length-1].toFixed(2);
                document.getElementById('ccfiValue').textContent = ccfiData[ccfiData.length-1].toFixed(2);
                document.getElementById('hrciValue').textContent = hrciData[hrciData.length-1].toFixed(1);
                
                const bdiChange = ((bdiData[bdiData.length-1] - bdiData[0]) / bdiData[0] * 100).toFixed(1);
                const scfiChange = ((scfiData[scfiData.length-1] - scfiData[0]) / scfiData[0] * 100).toFixed(1);
                const ccfiChange = ((ccfiData[ccfiData.length-1] - ccfiData[0]) / ccfiData[0] * 100).toFixed(1);
                const hrciChange = ((hrciData[hrciData.length-1] - hrciData[0]) / hrciData[0] * 100).toFixed(1);
                
                document.getElementById('bdiChange').textContent = `${bdiChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(bdiChange)}%`;
                document.getElementById('scfiChange').textContent = `${scfiChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(scfiChange)}%`;
                document.getElementById('ccfiChange').textContent = `${ccfiChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(ccfiChange)}%`;
                document.getElementById('hrciChange').textContent = `${hrciChange > 0 ? 'â–²' : 'â–¼'} ${Math.abs(hrciChange)}%`;
            }
        }

        // ì°¨íŠ¸ ìƒì„±
        function createIndexChart(timeRange) {
            const ctx = document.getElementById('indexChart').getContext('2d');
            
            if (charts.index) charts.index.destroy();
            
            let dataPoints = 52;
            switch(timeRange) {
                case '3M': dataPoints = 13; break;
                case '6M': dataPoints = 26; break;
                case '1Y': dataPoints = 52; break;
                case '2Y': dataPoints = 104; break;
            }
            
            const sliceStart = Math.max(0, currentData.dates.length - dataPoints);
            const labels = currentData.dates.slice(sliceStart).map(d => formatDate(d));
            
            charts.index = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'BDI',
                            data: currentData.indices.BDI.slice(sliceStart),
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'SCFI',
                            data: currentData.indices.SCFI.slice(sliceStart),
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'ìƒí•´â†’LA (USD/TEU)',
                            data: currentData.freight.shanghai.sea.la.slice(sliceStart),
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            tension: 0.4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'ì§€ìˆ˜' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: { display: true, text: 'ìš´ì„ (USD/TEU)' },
                            grid: { drawOnChartArea: false }
                        }
                    }
                }
            });
        }

        // ì´ˆê¸°í™”
        window.onload = function() {
            generateRealisticData();
            analyzeFreightChanges('1Y');
            createIndexChart('1Y');
            
            // ì‹œê°„ ë²”ìœ„ ë²„íŠ¼ ì´ë²¤íŠ¸
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const range = this.getAttribute('data-range');
                    analyzeFreightChanges(range);
                    createIndexChart(range);
                });
            });
        };
    </script>
</body>
</html>
